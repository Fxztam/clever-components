import"./cc-button.en-a4be867f.js";import"./cc-input-text.en-c550af5f.js";import"./cc-block-section.en-631a7ae5.js";import"./cc-block.en-4e616d98.js";import"./cc-error.en-5d22dc32.js";import{c as e,h as t,L as s}from"./lit-element-853ea71c.js";import{c as o}from"./class-map-70d3acb0.js";import{f as a}from"./fake-strings-0d4d5c0b.js";import{addTranslations as r,i18n as c,setLanguage as i}from"./i18n.en-08377c51.js";import{s as n}from"./skeleton-8eb08747.js";import{c as l,l as d}from"./cc-link-b32efd46.js";import{a as u,b as p,f as h}from"./i18n-date-e0185db0.js";import{s as m}from"./i18n-sanitize-91b739eb.js";const b=()=>m`You can delete this backup using <a href="https://curl.se/docs/">cURL</a> by executing this command:`,g=()=>m`Backups are created using the <a href="https://docs.mongodb.com/v4.0/reference/program/mongodump/">mongodump</a> tool.`,k=()=>m`Backups are created using the <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html">mysqldump</a> tool.`,v=()=>m`Backups are created using the <a href="https://www.postgresql.org/docs/current/app-pgdump.html">pg_dump</a> tool.`,y=()=>m`You can restore this backup using <a href="https://curl.se/docs/">cURL</a> by executing this command:`,f=()=>m`You can restore this backup using the <a href="https://docs.mongodb.com/v4.0/reference/program/mongorestore/">mongorestore</a> tool by executing this command:`,$=()=>m`You can restore this backup using the <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql.html">mysql</a> CLI by executing this command:`,_=()=>m`You can restore this backup using the <a href="https://www.postgresql.org/docs/current/app-pgrestore.html">pg_restore</a> tool by executing this command:`,w=new URL(new URL("assets/backup-fbacabea.svg",import.meta.url).href,import.meta.url).href,x=new URL(new URL("assets/close-410cee1c.svg",import.meta.url).href,import.meta.url).href,B={providerId:"",passwordForCommand:"",list:new Array(5).fill({createdAt:new Date,expiresAt:new Date})};class D extends s{static get properties(){return{backups:{type:Object},error:{type:Boolean},_overlay:{type:String,attribute:!1},_selectedBackup:{type:Object,attribute:!1}}}constructor(){super(),this.error=!1,this._overlay=null,this._selectedBackup=null}_getDescription(e){switch(e){case"es-addon":return"Backups are managed by Elasticsearch itself. You can define the retention period and backup frequency through Kibana's UI.";case"es-addon-old":return"Backups are managed by Elasticsearch itself. The version of your Elasticsearch does not allow to define a retention policy. Deleting a backup can be done manually through Elasticsearch's API.";case"postgresql-addon":return v;case"mysql-addon":return k;case"mongodb-addon":return g;case"redis-addon":return"Backups are created by archiving Redis's data.";case"jenkins":return"Backups are created by archiving Jenkins's data.";default:return a(150)}}_getBackupText({createdAt:e,expiresAt:t}){return null!=t?(({createdAt:e,expiresAt:t})=>m`Backup from <strong title="${h("en",e)}">${u("en",e)}</strong> (expires on <strong>${p("en",t)}</strong>)`)({createdAt:e,expiresAt:t}):(({createdAt:e})=>m`Backup from <strong title="${h("en",e)}">${u("en",e)}</strong> (expires after defined retention)`)({createdAt:e})}_getBackupLink(e){switch(e){case"es-addon":return"open in Kibana";case"es-addon-old":return"open in Elasticsearch";case"postgresql-addon":case"mysql-addon":case"mongodb-addon":case"redis-addon":case"jenkins":return"download";default:return a(18)}}_displaySectionWithService(e){return"es-addon"===e}_getRestoreWithServiceTitle(e){return"es-addon"===e?"Restore with Kibana":a(20)}_getRestoreWithServiceDescription(e,t){return"es-addon"===e?(({href:e})=>m`You can restore this backup using Kibana by going to the <a href="${e}">backup repository</a>.`)({href:t}):a(80)}_getManualRestoreDescription(e){switch(e){case"es-addon":case"es-addon-old":return y;case"postgresql-addon":return _;case"mysql-addon":return $;case"mongodb-addon":return f;case"redis-addon":return"Restoring a Redis backup must be done by our support team. Please open a support ticket containing the add-on ID and the backup to restore and we will do it for you.";case"jenkins":return"Restoring a Jenkins backup must be done by our support team. Please open a support ticket containing the add-on ID and the backup to restore and we will do it for you.";default:return a(70)}}_getDeleteWithServiceTitle(e){return"es-addon"===e?"Delete with Kibana":a(20)}_getDeleteWithServiceDescription(e,t){return"es-addon"===e?(({href:e})=>m`You can delete this backup using Kibana by going to the <a href="${e}">backup repository</a>.`)({href:t}):a(80)}_getManualDeleteDescription(e){switch(e){case"es-addon":case"es-addon-old":return b;default:return a(70)}}_onOpenOverlay(e,t,s){this._overlay=t,this._selectedBackup=s,this._overlayTarget=e.target,this.updateComplete.then((()=>{this.shadowRoot.querySelector(".overlay cc-button").focus(),this.shadowRoot.querySelector(".overlay").scrollIntoView({behavior:"smooth",block:"center"})}))}_onCloseOverlay(){this._overlay=null,this._selectedBackup=null,this.updateComplete.then((()=>{this._overlayTarget.focus(),this._overlayTarget.scrollIntoView({behavior:"smooth",block:"center"}),this._overlayTarget=null}))}render(){const e=null==this.backups,{providerId:s,list:a,passwordForCommand:r}=e?B:this.backups,c=!this.error&&a.length>0,i=!this.error&&0===a.length;return t`<cc-block><div slot=title>${"Backups"}</div>${c?t`<div><span class=${o({skeleton:e})}>${this._getDescription(s)}</span></div><div class=backup-list>${a.map((a=>t`<div class=backup><span class=backup-icon><img src=${w} alt=""></span><span class=backup-text><span class="${o({skeleton:e})} backup-text-details">${this._getBackupText(a)}</span><br>${l(null==this._overlay?a.url:null,this._getBackupLink(s),e)}<cc-button link ?disabled=${null!=this._overlay} ?skeleton=${e} @cc-button:click=${e=>this._onOpenOverlay(e,"restore",a)}>${"restore..."}</cc-button>${null!=a.deleteCommand?t`<cc-button link ?disabled=${null!=this._overlay} ?skeleton=${e} @cc-button:click=${e=>this._onOpenOverlay(e,"delete",a)}>${"delete..."}</cc-button>`:""}</span></div>`))}</div>`:""} ${i?t`<div class=cc-block_empty-msg>${"There are no backups yet."}</div>`:""} ${this.error?t`<cc-error>${"Something went wrong while loading the backups."}</cc-error>`:""} ${"restore"===this._overlay?t`<div slot=overlay><cc-block class=overlay><div slot=title>${(({createdAt:e})=>m`Restore the backup from <strong title="${h("en",e)}">${u("en",e)}</strong>`)(this._selectedBackup)}</div><cc-button slot=button image=${x} hide-text @cc-button:click=${this._onCloseOverlay}>${"Close this panel"}</cc-button>${this._displaySectionWithService(s)?t`<cc-block-section><div slot=title>${this._getRestoreWithServiceTitle(s)}</div><div>${this._getRestoreWithServiceDescription(s,this._selectedBackup.url)}</div></cc-block-section>`:""}<cc-block-section><div slot=title>${"Restore manually"}</div><div>${this._getManualRestoreDescription(s)}</div>${null!=this._selectedBackup.restoreCommand?t`<cc-input-text readonly=readonly clipboard value=${this._selectedBackup.restoreCommand}></cc-input-text><div>${"This command will ask for your password, here it is:"}</div><cc-input-text readonly=readonly clipboard secret value=${r}></cc-input-text>`:""}</cc-block-section></cc-block></div>`:""} ${"delete"===this._overlay?t`<div slot=overlay><cc-block class=overlay><div slot=title>${(({createdAt:e})=>m`Delete the backup from <strong title="${h("en",e)}">${u("en",e)}</strong>`)(this._selectedBackup)}</div><cc-button slot=button image=${x} hide-text @cc-button:click=${this._onCloseOverlay}>${"Close this panel"}</cc-button>${this._displaySectionWithService(s)?t`<cc-block-section><div slot=title>${this._getDeleteWithServiceTitle(s)}</div><div>${this._getDeleteWithServiceDescription(s,this._selectedBackup.url)}</div></cc-block-section>`:""}<cc-block-section><div slot=title>${"Delete manually"}</div><div>${this._getManualDeleteDescription(s)}</div><cc-input-text readonly=readonly clipboard value=${this._selectedBackup.deleteCommand}></cc-input-text><div>${"This command will ask for your password, here it is:"}</div><cc-input-text readonly=readonly clipboard secret value=${r}></cc-input-text></cc-block-section></cc-block></div>`:""}</cc-block>`}static get styles(){return[n,d,e`:host{display:grid;grid-gap:1rem;line-height:1.5}.backup-list{display:grid;grid-gap:1.5rem}.backup{display:flex;line-height:1.5rem}.backup-icon,.backup-text{margin-right:.5rem}.backup-icon{flex:0 0 auto;height:1.5rem;width:1.5rem}.backup-icon img{display:block;height:100%;width:100%}.backup-text{color:#555}.backup-text-details:not(.skeleton) strong{color:#000}[title]{cursor:help}.skeleton{background-color:#bbb}.overlay{box-shadow:0 0 1rem #aaa;margin:2rem;max-width:80%}.cc-link,cc-button[link]{margin-right:.5rem;vertical-align:baseline}`]}}window.customElements.define("cc-addon-backups",D),r("en",{}),i("en");export{D as CcAddonBackups};
